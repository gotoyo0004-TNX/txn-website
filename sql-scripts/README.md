# ğŸ“Š TXN ç³»çµ± SQL è…³æœ¬æŒ‡å—

æœ¬ç›®éŒ„åŒ…å« TXN äº¤æ˜“æ—¥èªŒç³»çµ±çš„æ‰€æœ‰è³‡æ–™åº«ç›¸é—œè…³æœ¬ã€‚è«‹æŒ‰ç…§ä»¥ä¸‹é †åºåŸ·è¡Œä»¥ç¢ºä¿ç³»çµ±æ­£å¸¸é‹ä½œã€‚

## ğŸš€ æ–°ç³»çµ±è¨­å®š (æ¨è–¦é †åº)

### 1. å®Œæ•´è³‡æ–™åº«è¨­å®š
```sql
-- åŸ·è¡Œæ­¤è…³æœ¬å»ºç«‹å®Œæ•´çš„è³‡æ–™åº«çµæ§‹
sql-scripts/complete_database_setup.sql
```
**åŠŸèƒ½ï¼š**
- å»ºç«‹æ‰€æœ‰æ ¸å¿ƒè³‡æ–™è¡¨ (user_profiles, strategies, trades, performance_snapshots)
- è¨­å®š RLS å®‰å…¨ç­–ç•¥
- å»ºç«‹ç´¢å¼•å’Œè§¸ç™¼å™¨
- è¨­å®šè‡ªå‹•åŒ–å‡½æ•¸

### 2. å»ºç«‹ç®¡ç†å“¡å¸³æˆ¶
```sql
-- å»ºç«‹åˆå§‹ç®¡ç†å“¡å¸³æˆ¶
sql-scripts/create_admin_user.sql
```
**åŠŸèƒ½ï¼š**
- å»ºç«‹æ¸¬è©¦ç®¡ç†å“¡å¸³æˆ¶ (admin@txn.test)
- è¨­å®šç®¡ç†å“¡æ¬Šé™
- æä¾›ç™»å…¥æŒ‡å¼•

### 3. ç³»çµ±å¥åº·æª¢æŸ¥
```sql
-- é©—è­‰ç³»çµ±è¨­å®šæ˜¯å¦æ­£ç¢º
sql-scripts/system_health_check.sql
```
**åŠŸèƒ½ï¼š**
- æª¢æŸ¥è³‡æ–™è¡¨çµæ§‹
- é©—è­‰ RLS ç­–ç•¥
- è¨ºæ–·å¸¸è¦‹å•é¡Œ
- æä¾›ä¿®å¾©å»ºè­°

## ğŸ”„ ç¾æœ‰ç³»çµ±å‡ç´š

### å‡ç´šåˆ° v2.0
```sql
-- å°‡ç¾æœ‰ç³»çµ±å‡ç´šåˆ°æœ€æ–°ç‰ˆæœ¬
sql-scripts/database_update_v2.sql
```
**åŠŸèƒ½ï¼š**
- å®‰å…¨åœ°æ›´æ–°è³‡æ–™è¡¨çµæ§‹
- ä¿ç•™ç¾æœ‰è³‡æ–™
- æ›´æ–° RLS ç­–ç•¥
- å„ªåŒ–ç´¢å¼•æ•ˆèƒ½

## ğŸ› ï¸ å•é¡Œä¿®å¾©è…³æœ¬

### RLS ç­–ç•¥å•é¡Œ
```sql
-- ä¿®å¾© RLS ç„¡é™éæ­¸å•é¡Œ
sql-scripts/fix_rls_simple_correct.sql
```

### ç®¡ç†å“¡æ¬Šé™å•é¡Œ
```sql
-- ä¿®å¾©ç®¡ç†å“¡æ¬Šé™ç›¸é—œå•é¡Œ
sql-scripts/fix_admin_permission.sql
```

### é€£æ¥å•é¡Œ
```sql
-- ä¿®å¾©è³‡æ–™åº«é€£æ¥å•é¡Œ
sql-scripts/emergency_connection_fix.sql
```

## ğŸ“‹ è…³æœ¬åˆ†é¡èªªæ˜

### ğŸ—ï¸ è¨­å®šè…³æœ¬
- `complete_database_setup.sql` - å®Œæ•´è³‡æ–™åº«è¨­å®š
- `create_admin_user.sql` - ç®¡ç†å“¡å¸³æˆ¶å»ºç«‹
- `database_update_v2.sql` - ç³»çµ±å‡ç´š

### ğŸ” è¨ºæ–·è…³æœ¬
- `system_health_check.sql` - ç³»çµ±å¥åº·æª¢æŸ¥
- `diagnose_*.sql` - å„ç¨®è¨ºæ–·å·¥å…·

### ğŸ› ï¸ ä¿®å¾©è…³æœ¬
- `fix_*.sql` - å„ç¨®å•é¡Œä¿®å¾©
- `emergency_*.sql` - ç·Šæ€¥ä¿®å¾©

### ğŸ“ é·ç§»è…³æœ¬
- `migrations/` - è³‡æ–™åº«ç‰ˆæœ¬é·ç§»è…³æœ¬

## âš ï¸ é‡è¦æ³¨æ„äº‹é …

### åŸ·è¡Œå‰æº–å‚™
1. **å‚™ä»½è³‡æ–™åº«** - åŸ·è¡Œä»»ä½•è…³æœ¬å‰è«‹å…ˆå‚™ä»½
2. **æ¸¬è©¦ç’°å¢ƒ** - å»ºè­°å…ˆåœ¨æ¸¬è©¦ç’°å¢ƒåŸ·è¡Œ
3. **ç¶­è­·æ™‚é–“** - åœ¨ä½æµé‡æ™‚é–“åŸ·è¡Œ

### åŸ·è¡Œé †åº
1. æ–°ç³»çµ±ï¼š`complete_database_setup.sql` â†’ `create_admin_user.sql` â†’ `system_health_check.sql`
2. å‡ç´šç³»çµ±ï¼š`database_update_v2.sql` â†’ `system_health_check.sql`
3. å•é¡Œä¿®å¾©ï¼šå…ˆåŸ·è¡Œè¨ºæ–·è…³æœ¬ï¼Œå†åŸ·è¡Œå°æ‡‰ä¿®å¾©è…³æœ¬

### å®‰å…¨è€ƒé‡
- æ‰€æœ‰è…³æœ¬éƒ½åŒ…å«å®‰å…¨æª¢æŸ¥
- RLS ç­–ç•¥ç¢ºä¿è³‡æ–™å®‰å…¨
- ç®¡ç†å“¡æ¬Šé™åš´æ ¼æ§åˆ¶

## ğŸ¯ å¸¸è¦‹ä½¿ç”¨å ´æ™¯

### å ´æ™¯ 1ï¼šå…¨æ–°éƒ¨ç½²
```bash
# 1. åœ¨ Supabase Dashboard åŸ·è¡Œ
complete_database_setup.sql

# 2. å»ºç«‹ç®¡ç†å“¡
create_admin_user.sql

# 3. é©—è­‰è¨­å®š
system_health_check.sql
```

### å ´æ™¯ 2ï¼šç³»çµ±å‡ç´š
```bash
# 1. å‚™ä»½è³‡æ–™åº«
# 2. åŸ·è¡Œå‡ç´šè…³æœ¬
database_update_v2.sql

# 3. æª¢æŸ¥ç³»çµ±ç‹€æ…‹
system_health_check.sql
```

### å ´æ™¯ 3ï¼šå•é¡Œæ’é™¤
```bash
# 1. åŸ·è¡Œå¥åº·æª¢æŸ¥
system_health_check.sql

# 2. æ ¹æ“šçµæœåŸ·è¡Œå°æ‡‰ä¿®å¾©è…³æœ¬
fix_rls_simple_correct.sql  # RLS å•é¡Œ
fix_admin_permission.sql    # æ¬Šé™å•é¡Œ
```

## ğŸ“ æ”¯æ´è³‡è¨Š

### åŸ·è¡Œç’°å¢ƒ
- **Supabase Dashboard** - SQL Editor
- **psql** - å‘½ä»¤åˆ—å·¥å…·
- **pgAdmin** - åœ–å½¢åŒ–å·¥å…·

### æ—¥èªŒæŸ¥çœ‹
åŸ·è¡Œè…³æœ¬å¾Œï¼Œè«‹æŸ¥çœ‹ï¼š
1. Supabase Dashboard çš„ Logs
2. æ‡‰ç”¨ç¨‹å¼çš„ Console è¼¸å‡º
3. ç€è¦½å™¨é–‹ç™¼è€…å·¥å…·

### å¸¸è¦‹éŒ¯èª¤
1. **æ¬Šé™ä¸è¶³** - ç¢ºä¿ä½¿ç”¨ service_role key
2. **è¡¨å·²å­˜åœ¨** - è…³æœ¬åŒ…å« IF EXISTS æª¢æŸ¥
3. **RLS éæ­¸** - ä½¿ç”¨ fix_rls_simple_correct.sql

## ğŸ”„ ç‰ˆæœ¬æ­·å²

### v2.0 (2024-12-19)
- å®Œæ•´é‡æ§‹è³‡æ–™åº«æ¶æ§‹
- æ–°å¢å®Œæ•´çš„ RLS å®‰å…¨ç­–ç•¥
- å„ªåŒ–ç´¢å¼•æ•ˆèƒ½
- æ–°å¢ç³»çµ±å¥åº·æª¢æŸ¥

### v1.0 (2024-08-25)
- åˆå§‹è³‡æ–™åº«çµæ§‹
- åŸºæœ¬ RLS ç­–ç•¥
- ç®¡ç†å“¡æ¬Šé™ç³»çµ±

## ğŸ“š ç›¸é—œæ–‡ä»¶

- [éƒ¨ç½²æŒ‡å—](../DEPLOYMENT_GUIDE.md)
- [å°ˆæ¡ˆäº¤æ¥æ–‡ä»¶](../PROJECT_HANDOVER.md)
- [Supabase è¨­å®šæŒ‡å—](../SUPABASE_SETUP.md)

---

**é‡è¦æé†’ï¼š** åŸ·è¡Œä»»ä½• SQL è…³æœ¬å‰ï¼Œè«‹å‹™å¿…å‚™ä»½è³‡æ–™åº«ä¸¦åœ¨æ¸¬è©¦ç’°å¢ƒä¸­é©—è­‰ï¼
